<!--
Client ID
1042823691233-f8jpdg1bvkshddtnmgae9j1ahgrmsk0a.apps.googleusercontent.com
API Key
AIzaSyA65nKT0N5h7fkQWFz8aDA4wt2z6-foksM
Sheet ID
1mJPO-Wcj96_yK8IYndb3ERqJ1vqZUIv5tRT-RMlIfaw
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets API Demo</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script>
        let gapiLoaded = false;
        let isSignedIn = false;
        let sheetId = '1mJPO-Wcj96_yK8IYndb3ERqJ1vqZUIv5tRT-RMlIfaw'; // Change this to your Google Sheet ID

        // Client ID from Google API console
        const CLIENT_ID = '1042823691233-f8jpdg1bvkshddtnmgae9j1ahgrmsk0a.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyA65nKT0N5h7fkQWFz8aDA4wt2z6-foksM'; // Optional if you're not using OAuth
        const SCOPES = 'https://www.googleapis.com/auth/spreadsheets';
        const DISCOVERY_DOCS = ['https://sheets.googleapis.com/$discovery/rest?version=v4'];

        function start() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES,
            }).then(function() {
                gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
                updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            });
        }

        function updateSigninStatus(isSignedIn) {
            isSignedIn = gapi.auth2.getAuthInstance().isSignedIn.get();
            gapiLoaded = true;
            if (isSignedIn) {
                document.getElementById('signinButton').style.display = 'none';
                document.getElementById('signoutButton').style.display = 'block';
                isSignedIn = true;
            } else {
                document.getElementById('signinButton').style.display = 'block';
                document.getElementById('signoutButton').style.display = 'none';
                isSignedIn = false;
            }
        }

        function handleSignInClick(event) {
            gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignOutClick(event) {
            gapi.auth2.getAuthInstance().signOut();
        }

        function readData() {
            if (!gapiLoaded || !isSignedIn) {
                alert('You must sign in first!');
                return;
            }
            const range = 'Sheet1!A1:B10'; // Adjust range based on your sheet
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: sheetId,
                range: range,
            }).then(function(response) {
                const result = response.result;
                if (result.values && result.values.length > 0) {
                    console.log('Data:', result.values);
                    alert('Data read successfully!');
                } else {
                    alert('No data found.');
                }
            });
        }

        function writeData() {
            if (!gapiLoaded || !isSignedIn) {
                alert('You must sign in first!');
                return;
            }
            const values = [
                ['Hello', 'World'], // Example data to write
                ['Another', 'Row']
            ];
            const body = {
                values: values,
            };
            gapi.client.sheets.spreadsheets.values.update({
                spreadsheetId: sheetId,
                range: 'Sheet1!A1', // Update this range based on where you want to write
                valueInputOption: 'RAW',
                resource: body,
            }).then(function(response) {
                alert('Data written successfully!');
            }, function(error) {
                alert('Error writing data: ' + error.message);
            });
        }

        // Load Google API client library
        function loadClient() {
            gapi.load('client:auth2', start);
        }
    </script>
</head>
<body onload="loadClient()">
    <h1>Google Sheets API Example</h1>

    <button id="signinButton" onclick="handleSignInClick()">Sign In</button>
    <button id="signoutButton" onclick="handleSignOutClick()" style="display:none">Sign Out</button>

    <br>
    <button onclick="readData()">Read Data from Sheet</button>
    <button onclick="writeData()">Write Data to Sheet</button>

</body>
</html>